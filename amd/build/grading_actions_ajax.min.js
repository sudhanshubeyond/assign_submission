define(["jquery","core/ajax","core/templates","core/notification",],function(e,t,i,a){return{init:function(){var t,i,a=window.location.href,n=r("id",a),c=r("userid",a),d=100;e(document).on("click","#id_fill_ai_grade",(t=function(t){e(this).attr("data-programid"),e(this).attr("data-id"),e(this).attr("cmid"),e.ajax({url:M.cfg.wwwroot+"/local/assign_submission/ajax.php",method:"POST",data:{action:"getgrades",cmid:n,userid:c,sesskey:M.cfg.sesskey},success:function(t){try{if(200==t.status){let i=JSON.parse(t.rubricbreakdown);i.forEach(e=>{let t=`advancedgrading-criteria-${e.criterionid}-levels-${e.selectedlevelid}`,i=`advancedgrading-criteria-${e.criterionid}-remark`,a=document.getElementById(t),r=document.getElementById(i);r?(r.value=e.feedback,r.style.display="block"):console.warn(`Textarea not found for criterion ${e.criterionid}`),a?a.click():console.warn(`Element with ID '${t}' not found.`)}),e("#id_assignfeedbackcomments_editoreditable").html(t.feedback),e("#id_grade").val(t.grade)}}catch(a){alert("There is some issue please try again later")}},error:function(e){alert("AJAX error: "+e.statusText)}})},i=0,function(){var e=this,a=arguments;clearTimeout(i),i=setTimeout(function(){t.apply(e,a)},100)}))}};function r(e,t){return decodeURIComponent((RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(t)||[null,""])[1].replace(/\+/g,"%20"))||null}});